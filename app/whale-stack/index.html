<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhaleStack | Asset Tracker</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="lib/fonts.css">
    <link rel="manifest" href="manifest.json">
    <script src="lib/chart.js"></script>
</head>

<body class="dark-theme">
    <div class="app-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="brand">
                <img src="images/whale_logo.jpg" alt="WhaleStack Logo" class="brand-logo-img">
                <div class="brand-info">
                    <span class="brand-name">WhaleStack</span>
                    <span class="brand-version">ver. 5.4</span>
                </div>
            </div>


            <nav class="side-nav">
                <a href="#" class="nav-item active" id="dashboard-nav">
                    <span class="icon">üìä</span> Dashboard
                </a>
                <a href="#" class="nav-item" id="portfolio-nav">
                    <span class="icon">üíº</span> Portfolio
                </a>
                <a href="#" class="nav-item" id="db-nav">
                    <span class="icon">üìÅ</span> Database
                </a>
                <a href="#" class="nav-item" id="about-nav">
                    <span class="icon">‚ÑπÔ∏è</span> About
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="top-bar">
                <div class="status-info">
                    <div class="status-line">
                        <span id="db-status" class="status-badge disconnect" title="File system status">No DB
                            Connected</span>
                        <div id="active-filename" class="active-file-info" style="display: none;">
                            <span class="label">Active:</span>
                            <span class="file-label"></span>
                        </div>
                    </div>
                    <div id="last-updated-container" class="update-info" style="display: none;">
                        <span class="label">LastUpdate:</span>
                        <span id="global-last-updated">-</span>
                    </div>
                </div>
            </header>

            <!-- View: Dashboard -->
            <section class="dashboard-grid" id="dashboard-view">
                <div class="dashboard-top-section">
                    <!-- Big Stats Card -->
                    <div class="card summary-card">
                        <div
                            style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 24px;">
                            <span
                                style="color:var(--text-muted); font-size: 0.8rem; font-weight:800; letter-spacing:1px;">PORTFOLIO
                                SUMMARY</span>
                            <div
                                style="background:var(--bg-main); padding: 4px; border-radius: 8px; display:flex; gap:4px;">
                                <span
                                    style="font-size:0.7rem; font-weight:800; padding:4px 10px; background:white; border-radius:6px; color:var(--primary); box-shadow:0 1px 3px rgba(0,0,0,0.1)">LOCAL</span>
                            </div>
                        </div>
                        <div class="balance-main">
                            <h2 id="total-balance">$0.00</h2>
                            <div id="total-change" class="change-info">
                                <span class="percent">0.00%</span>
                            </div>
                        </div>
                        <div class="chart-area">
                            <canvas id="balanceChart"></canvas>
                        </div>
                    </div>

                    <!-- Global Market Panel -->
                    <div class="live-market-panel">
                        <!-- Panel Content -->
                        <div class="panel-inner">
                            <!-- Cryptocurrencies Section -->
                            <div class="market-section">
                                <div class="section-header">
                                    <span class="header-icon">üåê</span>
                                    <span class="header-title">Digital Asset Monitor</span>
                                </div>
                                <div class="market-list">
                                    <div class="market-item" id="btc-row">
                                        <div class="m-coin">
                                            <span class="m-icon" style="color:#f7931a;">‚Çø</span>
                                            <span class="m-name">BTC</span>
                                        </div>
                                        <div class="m-stats">
                                            <span class="m-price" id="btc-price">Loading...</span>
                                            <span class="m-pct" id="btc-badge">0.00%</span>
                                        </div>
                                    </div>
                                    <div class="market-item" id="eth-row">
                                        <div class="m-coin">
                                            <span class="m-icon" style="color:#627eea;">Œû</span>
                                            <span class="m-name">ETH</span>
                                        </div>
                                        <div class="m-stats">
                                            <span class="m-price" id="eth-price">Loading...</span>
                                            <span class="m-pct" id="eth-badge">0.00%</span>
                                        </div>
                                    </div>
                                    <div class="market-item" id="sol-row">
                                        <div class="m-coin">
                                            <span class="m-icon" style="color:#14f195;">‚óé</span>
                                            <span class="m-name">SOL</span>
                                        </div>
                                        <div class="m-stats">
                                            <span class="m-price" id="sol-price">Loading...</span>
                                            <span class="m-pct" id="sol-badge">0.00%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Markets & Commodities Section -->
                            <div class="market-section" style="margin-top: 25px;">
                                <div class="section-header">
                                    <span class="header-icon">üìâ</span>
                                    <span class="header-title">World Market Indices</span>
                                </div>
                                <div class="market-list">
                                    <div class="market-item">
                                        <div class="m-coin">
                                            <span class="m-icon">üìà</span>
                                            <span class="m-name">S&P 500</span>
                                        </div>
                                        <div class="m-stats">
                                            <span class="m-price" id="sp500-price">6909.51 USD</span>
                                            <span class="m-pct" id="sp500-badge" style="color:var(--up)">(0.69%)</span>
                                        </div>
                                    </div>
                                    <div class="market-item">
                                        <div class="m-coin">
                                            <span class="m-icon">üíª</span>
                                            <span class="m-name">Nasdaq</span>
                                        </div>
                                        <div class="m-stats">
                                            <span class="m-price" id="nasdaq-price">22886.068 USD</span>
                                            <span class="m-pct" id="nasdaq-badge" style="color:var(--up)">(0.90%)</span>
                                        </div>
                                    </div>
                                    <div class="market-item">
                                        <div class="m-coin">
                                            <span class="m-icon">üèõÔ∏è</span>
                                            <span class="m-name">Dow Jones</span>
                                        </div>
                                        <div class="m-stats">
                                            <span class="m-price" id="dow-price">49625.97 USD</span>
                                            <span class="m-pct" id="dow-badge" style="color:var(--up)">(0.47%)</span>
                                        </div>
                                    </div>
                                    <div class="market-item">
                                        <div class="m-coin">
                                            <span class="m-icon">üí∞</span>
                                            <span class="m-name">Gold</span>
                                        </div>
                                        <div class="m-stats">
                                            <span class="m-price" id="gold-price">5080.9 USD</span>
                                            <span class="m-pct" id="gold-badge" style="color:var(--up)">(1.67%)</span>
                                        </div>
                                    </div>
                                    <div class="market-item">
                                        <div class="m-coin">
                                            <span class="m-icon">üõ¢Ô∏è</span>
                                            <span class="m-name">Brent</span>
                                        </div>
                                        <div class="m-stats">
                                            <span class="m-price" id="brent-price">71.3 USD</span>
                                            <span class="m-pct" id="brent-badge" style="color:var(--up)">(0.04%)</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="distribution-row">
                    <div class="card">
                        <h3>Allocations</h3>
                        <div class="mini-list-container" id="allocation-list">
                            <!-- List items will be injected here via JS -->
                        </div>
                    </div>
                    <div class="card">
                        <h3>App Info</h3>
                        <div style="display:flex; flex-direction:column; gap:20px; margin-top:32px;">
                            <div
                                style="display:flex; justify-content:space-between; border-bottom:1px solid var(--border); padding-bottom:12px;">
                                <span style="color:var(--text-muted); font-weight:600">Storage Mode</span>
                                <span style="font-weight:800">Local JSON</span>
                            </div>
                            <div
                                style="display:flex; justify-content:space-between; border-bottom:1px solid var(--border); padding-bottom:12px;">
                                <span style="color:var(--text-muted); font-weight:600">Privacy</span>
                                <span style="font-weight:800">100% Offline / Local</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- View: Portfolio -->
            <section id="portfolio-view" style="display: none; padding: 32px 40px;">
                <div class="card table-card">
                    <div class="table-header-row">
                        <h3>Asset Inventory Management</h3>
                        <div class="table-actions">
                            <button id="edit-mode-btn" class="btn-secondary">Edit
                                Portfolio</button>
                            <div id="edit-controls" style="display: none; gap: 12px;">
                                <button id="cancel-edit-btn" class="btn-text">Cancel</button>
                                <button id="save-changes-btn" class="btn-primary">Save
                                    Changes</button>
                            </div>
                            <button id="add-asset-btn" class="btn-primary" disabled>+ Add Asset</button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th class="edit-only" style="width: 40px;"></th>
                                    <th>Assets</th>
                                    <th>Category</th>
                                    <th>Amount</th>
                                    <th>Avg Cost ($)</th>
                                    <th>Circulating Supply</th>
                                    <th>Max Supply</th>
                                    <th>Risk Level</th>
                                    <th class="edit-only"></th>
                                </tr>
                            </thead>
                            <tbody id="assets-body"></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- View: Database Manager -->
            <section class="db-view-flex" id="db-view" style="display: none;">
                <div class="card db-manager-card">
                    <div class="db-header-content">
                        <h2 style="margin-top: 10px; font-size: 2.2rem; font-weight:800;">Database Manager</h2>
                        <p style="color:var(--text-muted); margin-top:12px;">Manage your local JSON portfolio storage
                            securely</p>
                    </div>

                    <div class="db-options-grid">
                        <div class="db-option-card" id="btn-create-new">
                            <span class="opt-icon">üÜï</span>
                            <h4>Create New</h4>
                            <p>Start a fresh portfolio file</p>
                        </div>
                        <div class="db-option-card" id="btn-connect-existing">
                            <span class="opt-icon">üìÅ</span>
                            <h4>Connect Existing</h4>
                            <p>Link your database.json file</p>
                        </div>
                    </div>

                    <div style="margin-top: 40px; border-top: 1px solid var(--border); padding-top: 30px;">
                        <div
                            style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                            <span style="color:var(--text-muted); font-weight:600;">Connection Status:</span>
                            <span id="db-manager-status" class="status-badge disconnect">Not Connected</span>
                        </div>
                        <div id="db-mgr-file-row"
                            style="display:none; justify-content:space-between; align-items:center;">
                            <span style="color:var(--text-muted); font-weight:600;">Active File:</span>
                            <span id="db-mgr-filename"
                                style="color:var(--primary); font-weight:800;">database.json</span>
                        </div>
                    </div>
                </div>

                <!-- Slogan Panel -->
                <div class="db-slogan-panel">
                    <img src="images/cz-publish.jpg" alt="CZ Slogan" class="db-side-slogan">
                </div>
            </section>
        </main>
    </div>

    <!-- Modals -->
    <div id="about-modal" class="modal">
        <div class="modal-content about-sleek-compact">
            <button id="close-about-btn" class="close-x-btn">√ó</button>

            <div class="about-main-layout">
                <div class="about-left">
                    <img src="images/whale_logo.jpg" alt="User Avatar" class="sleek-avatar-img">
                </div>
                <div class="about-right">
                    <h2 class="brand-title">WhaleStack</h2>
                    <p class="brand-tagline">Deep Sea Asset Tracker</p>

                    <h3 class="name-display">faruk-guler</h3>
                    <p class="role-display">SysAdmin & Developer</p>

                    <div class="compact-links">
                        <a href="https://www.farukguler.com" target="_blank" class="mini-link">üåê Website</a>
                        <a href="https://github.com/faruk-guler" target="_blank" class="mini-link">üêô GitHub</a>
                    </div>
                </div>
            </div>

            <div class="compact-footer">
                <span>Built for Whales</span>
                <span class="dot-sep">‚Ä¢</span>
                <div class="logo">
                    <span class="logo-icon">üêã</span>
                    <span class="logo-text">WhaleStack</span>
                </div>
                <span>v5.4</span>
                <span class="dot-sep">‚Ä¢</span>
                <span>¬© 2025</span>
            </div>
        </div>
    </div>

    <div id="asset-modal" class="modal">
        <div class="modal-content">
            <h2 style="margin-bottom:32px;">Add Asset</h2>
            <form id="add-asset-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>Asset Name / Symbol</label>
                        <input type="text" id="asset-id" placeholder="BTC, ETH, Gold..." required>
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <input type="text" id="asset-category" placeholder="Altcoin, L1, Commodity...">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Amount</label>
                        <input type="number" id="asset-amount" step="any" required>
                    </div>
                    <div class="form-group">
                        <label>Avg Cost ($)</label>
                        <input type="number" id="asset-cost" step="any" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Circulating Supply</label>
                        <input type="text" id="asset-circulating" placeholder="e.g. 19M, 1.2B">
                    </div>
                    <div class="form-group">
                        <label>Max Supply</label>
                        <input type="text" id="asset-max" placeholder="e.g. 21M, ‚àû">
                    </div>
                    <div class="form-group">
                        <label>Risk Level</label>
                        <select id="asset-risk"
                            style="width: 100%; padding: 14px; border: 1px solid var(--border); border-radius: 12px; font-size: 1rem;">
                            <option value="Low">Low</option>
                            <option value="Mid">Mid</option>
                            <option value="High">High</option>
                        </select>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" id="close-modal" class="btn-text">Cancel</button>
                    <button type="submit" class="btn-primary">Add Asset</button>
                </div>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>